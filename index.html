<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Bingo Wheel</title>
<style>
  body {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
    background: #f3f4f6;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    gap: 50px;
  }

  .left-side {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 10px;
  }

  .bingo-board {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    border: 3px solid #000;
    text-align: center;
    background: #fff;
    width: 500px;
    height: 500px;
  }

  .bingo-cell {
    border: 1px solid #000;
    font-weight: bold;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 18px;
  }

  .bingo-header {
    background: #111827;
    color: white;
    font-size: 22px;
  }

  .highlighted {
    background: #ef4444;
    border: 2px solid #000;
    color: white;
  }

  .reset-btn {
    padding: 10px 20px;
    font-size: 16px;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    background: #ef4444;
    color: white;
    transition: background 0.3s ease;
  }
  .reset-btn:hover { background: #b91c1c; }

  .wheel-container { position: relative; width: 420px; height: 420px; }
  svg { width:100%; height:100%; display:block; border-radius:50%; }

  .pointer {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%) rotate(180deg);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 25px solid #111827;
    z-index: 10;
  }

  .color-blue     { fill: #6ec1ff; }
  .color-lavender { fill: #c48bff; }
  .color-yellow   { fill: #ffe066; }
  .color-green    { fill: #80e472; }
  .color-orange   { fill: #ffb366; }

  .slice:hover { filter:brightness(1.15); transform-origin:200px 200px; }

  .slice-label {
    font-weight:700;
    font-size:9px;
    fill:#111;
    pointer-events:none;
    text-anchor:middle;
    dominant-baseline:middle;
  }

  .center {
    fill:#111827;
    opacity:0.06;
    stroke:#00000010;
  }

  .spin-btn {
    margin-top: 30px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: 600;
    background: #111827;
    color: #fff;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .spin-btn:hover { background: #374151; }

  .right-side {
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Custom alert */
  #customAlert {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 25px 30px;
    border: 3px solid #ef4444;
    border-radius: 10px;
    z-index: 1000;
    font-family: sans-serif;
    text-align: center;
    box-shadow: 0 4px 20px rgba(0,0,0,0.3);
  }
  #customAlert p {
    margin: 0 0 15px 0;
    font-size: 80px;
  }
  #customAlert button {
    padding: 8px 20px;
    font-size: 16px;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    background: #ef4444;
    color: white;
    cursor: pointer;
  }
  #customAlert button:hover { background: #b91c1c; }
</style>
</head>
<body>

<div class="left-side">
  <div class="bingo-board" id="bingoBoard"></div>
  <button class="reset-btn" id="resetBtn">Reset</button>
</div>

<div class="right-side">
  <div class="wheel-container">
    <div class="pointer"></div>
    <svg viewBox="0 0 400 400" id="wheel"></svg>
  </div>
  <button class="spin-btn" id="spinBtn">ðŸŽ¡ Spin</button>
</div>

<!-- Custom alert -->
<div id="customAlert">
  <p id="alertText"></p>
  <button onclick="closeAlert()">OK</button>
</div>

<!-- ðŸŽµ Sound -->
<audio id="spinSound" src="spineffect.mp3" preload="auto"></audio>

<script>
const board = document.getElementById('bingoBoard');
const headers = ['B','I','N','G','O'];
const totalNumbers = 75;
const highlightedNumbers = new Set();

// Create Bingo board
headers.forEach(h => {
  const cell = document.createElement('div');
  cell.className = 'bingo-cell bingo-header';
  cell.textContent = h;
  board.appendChild(cell);
});
for (let row=0; row<15; row++) {
  for (let col=0; col<5; col++) {
    const num = col*15 + (row+1);
    const cell = document.createElement('div');
    cell.className = 'bingo-cell';
    cell.textContent = num;
    cell.id = `bingo-${num}`;
    board.appendChild(cell);
  }
}

// Create wheel
const svg = document.getElementById('wheel');
const cx=200, cy=200, r=180;
const degPerSlice = 360/totalNumbers;
const g = document.createElementNS('http://www.w3.org/2000/svg','g');
svg.appendChild(g);

let startDeg=-90;
for(let i=0;i<totalNumbers;i++){
  const endDeg=startDeg+degPerSlice;
  const startRad=startDeg*Math.PI/180;
  const endRad=endDeg*Math.PI/180;
  const x1=cx+r*Math.cos(startRad);
  const y1=cy+r*Math.sin(startRad);
  const x2=cx+r*Math.cos(endRad);
  const y2=cy+r*Math.sin(endRad);
  const d=`M ${cx} ${cy} L ${x1} ${y1} A ${r} ${r} 0 0 1 ${x2} ${y2} Z`;

  let colorClass='';
  if(i<15) colorClass='color-blue';
  else if(i<30) colorClass='color-lavender';
  else if(i<45) colorClass='color-yellow';
  else if(i<60) colorClass='color-green';
  else colorClass='color-orange';

  const slice=document.createElementNS('http://www.w3.org/2000/svg','path');
  slice.setAttribute('d',d);
  slice.setAttribute('class',`slice ${colorClass}`);
  slice.setAttribute('id',`slice-${i+1}`);
  g.appendChild(slice);

  const midDeg=startDeg+degPerSlice/2;
  const midRad=midDeg*Math.PI/180;
  const textR=r*0.9;
  const tx=cx+textR*Math.cos(midRad);
  const ty=cy+textR*Math.sin(midRad);
  const text=document.createElementNS('http://www.w3.org/2000/svg','text');
  text.setAttribute('x',tx);
  text.setAttribute('y',ty);
  text.setAttribute('class','slice-label');
  text.setAttribute('transform',`rotate(${midDeg+90},${tx},${ty})`);
  text.textContent=i+1;
  g.appendChild(text);

  startDeg=endDeg;
}

const centerCircle=document.createElementNS('http://www.w3.org/2000/svg','circle');
centerCircle.setAttribute('cx',cx);
centerCircle.setAttribute('cy',cy);
centerCircle.setAttribute('r',32);
centerCircle.setAttribute('class','center');
svg.appendChild(centerCircle);

const spinBtn=document.getElementById('spinBtn');
const resetBtn=document.getElementById('resetBtn');
const spinSound=document.getElementById('spinSound');
let spinning=false;
let currentRotation=0;

// Custom alert
let alertTimeout;
function showAlert(msg){
  document.getElementById('alertText').textContent = msg;
  const alertBox = document.getElementById('customAlert');
  alertBox.style.display = 'block';
  if(alertTimeout) clearTimeout(alertTimeout);
  alertTimeout = setTimeout(() => {
    alertBox.style.display = 'none';
  }, 3000);
}
function closeAlert(){
  document.getElementById('customAlert').style.display = 'none';
  if(alertTimeout) clearTimeout(alertTimeout);
}

// ðŸŽ¯ Spin logic - 10 seconds total
spinBtn.addEventListener('click', async () => {
  if (spinning) return;
  if (highlightedNumbers.size === totalNumbers) {
    showAlert('All numbers have been picked!');
    return;
  }

  spinning = true;

  // ðŸ”Š Play sound
  try {
    spinSound.currentTime = 0;
    spinSound.loop = true;
    await spinSound.play();
  } catch (err) {
    console.warn("Sound could not play:", err);
  }

  // Spin settings (10s duration)
  const spinDuration = 10 * 1000; // ms
  const randomSpin = 8 + Math.random() * 4;
  let rotation = currentRotation + randomSpin * 360 + Math.random() * 360;

  svg.style.transition = `transform 10s cubic-bezier(0.33,1,0.68,1)`;
  svg.style.transform = `rotate(${rotation}deg)`;
  currentRotation = rotation;

  // Show result at exactly 10 seconds
  setTimeout(() => {
    spinSound.loop = false;
    spinSound.pause();
    spinSound.currentTime = 0;
    spinning = false;

    let winningNumber;
    do {
      const normalized = rotation % 360;
      const pointerAngle = (360 - normalized) % 360;
      const winningSliceIndex = Math.floor(pointerAngle / degPerSlice);
      winningNumber = winningSliceIndex + 1;
      if (highlightedNumbers.has(winningNumber)) {
        rotation += 15 + Math.random() * 10;
      }
    } while (highlightedNumbers.has(winningNumber));

    highlightedNumbers.add(winningNumber);

    const winningSlice = document.getElementById(`slice-${winningNumber}`);
    winningSlice.style.filter='brightness(1.25)';

    const winningCell = document.getElementById(`bingo-${winningNumber}`);
    if(winningCell) winningCell.classList.add('highlighted');

    let letter = '';
    if(winningNumber >= 1 && winningNumber <= 15) letter = 'B';
    else if(winningNumber <= 30) letter = 'I';
    else if(winningNumber <= 45) letter = 'N';
    else if(winningNumber <= 60) letter = 'G';
    else letter = 'O';

    showAlert(`ðŸŽ‰ Sa letrang ${letter}: ${winningNumber}`);
  }, spinDuration);
});

// Reset
resetBtn.addEventListener('click', () => {
  const password = prompt("Enter password to reset:");
  if(password === "1234"){
    highlightedNumbers.clear();
    document.querySelectorAll('.bingo-cell.highlighted').forEach(c=>c.classList.remove('highlighted'));
    document.querySelectorAll('.slice').forEach(s=>s.style.filter='');
    currentRotation=0;
    svg.style.transition='';
    svg.style.transform='rotate(0deg)';
  } else {
    showAlert("Incorrect password. Reset cancelled!");
  }
});
</script>
</body>
</html>
